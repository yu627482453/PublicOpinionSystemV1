<!-- Page Heading -->
<h1 class="h3 mb-2 text-gray-800">Charts</h1>
<p class="mb-4">Chart.js is a third party plugin that is used to generate the charts in this theme. The charts below
    have been customized - for further customization options, please visit the <a target="_blank"
        href="https://www.chartjs.org/docs/latest/">official Chart.js documentation</a>.</p>

<!-- Content Row -->
<div class="row">

    <div class="col-xl-8 col-lg-7">

        <!-- Area Chart -->
        <div class="card shadow mb-4">
            <div class="card-header py-3">
                <h6 class="m-0 font-weight-bold text-primary">Bar day</h6>
            </div>
            <div class="card-body">
                <div class="chart-area" id="bar_charts_day">
                </div>
                <hr>
                日热点柱状图.
            </div>
        </div>

    </div>

    <!-- Donut Chart -->
    <div class="col-xl-4 col-lg-5">
        <div class="card shadow mb-4">
            <!-- Card Header - Dropdown -->
            <div class="card-header py-3">
                <h6 class="m-0 font-weight-bold text-primary">WordCloud day</h6>
            </div>
            <!-- Card Body -->
            <div class="card-body">
                <div class="chart-pie pt-4" id="word_charts_day">
                </div>
                <hr>
                日热点词云图.
            </div>
        </div>
    </div>

    <div class="col-xl-8 col-lg-7">

        <!-- Area Chart -->
        <div class="card shadow mb-4">
            <div class="card-header py-3">
                <h6 class="m-0 font-weight-bold text-primary">Bar yes_day</h6>
            </div>
            <div class="card-body">
                <div class="chart-area" id="bar_charts_yes_day">
                </div>
                <hr>
                昨日日热点柱状图.
            </div>
        </div>

    </div>

    <div class="col-xl-4 col-lg-5">
        <div class="card shadow mb-4">
            <!-- Card Header - Dropdown -->
            <div class="card-header py-3">
                <h6 class="m-0 font-weight-bold text-primary">WordCloud yes_day</h6>
            </div>
            <!-- Card Body -->
            <div class="card-body">
                <div class="chart-pie pt-4" id="word_charts_yes_day">
                </div>
                <hr>
                昨日日热点词云图.
            </div>
        </div>
    </div>

    <div class="col-xl-8 col-lg-7">
        <!-- Area Chart -->
        <div class="card shadow mb-4">
            <div class="card-header py-3">
                <h6 class="m-0 font-weight-bold text-primary">Bar last_day</h6>
            </div>
            <div class="card-body">
                <div class="chart-area" id="bar_charts_last_day">
                </div>
                <hr>
                前日日热点柱状图.
            </div>
        </div>
    </div>

    <div class="col-xl-4 col-lg-5">
        <div class="card shadow mb-4">
            <!-- Card Header - Dropdown -->
            <div class="card-header py-3">
                <h6 class="m-0 font-weight-bold text-primary">WordCloud last_day</h6>
            </div>
            <!-- Card Body -->
            <div class="card-body">
                <div class="chart-pie pt-4" id="word_charts_last_day">
                </div>
                <hr>
                前日日热点词云图.
            </div>
        </div>
    </div>

</div>

<script type="text/javascript">
    function draw_bar_charts(app, id, x_axis, data1, data2, data3) {

        if (app != null && app != "" && app != undefined) {
            app.dispose();
        }

        var app = echarts.init(document.getElementById(id));

        var posList = [
            'left', 'right', 'top', 'bottom',
            'inside',
            'insideTop', 'insideLeft', 'insideRight', 'insideBottom',
            'insideTopLeft', 'insideTopRight', 'insideBottomLeft', 'insideBottomRight'
        ];

        app.configParameters = {
            rotate: {
                min: -90,
                max: 90
            },
            align: {
                options: {
                    left: 'left',
                    center: 'center',
                    right: 'right'
                }
            },
            verticalAlign: {
                options: {
                    top: 'top',
                    middle: 'middle',
                    bottom: 'bottom'
                }
            },
            position: {
                options: echarts.util.reduce(posList, function (map, pos) {
                    map[pos] = pos;
                    return map;
                }, {})
            },
            distance: {
                min: 0,
                max: 100
            }
        };

        app.config = {
            rotate: 90,
            align: 'left',
            verticalAlign: 'middle',
            position: 'insideBottom',
            distance: 15,
            onChange: function () {
                var labelOption = {
                    normal: {
                        rotate: app.config.rotate,
                        align: app.config.align,
                        verticalAlign: app.config.verticalAlign,
                        position: app.config.position,
                        distance: app.config.distance
                    }
                };
                myChart.setOption({
                    series: [{
                        label: labelOption
                    }, {
                        label: labelOption
                    }, {
                        label: labelOption
                    }]
                });
            }
        };


        var labelOption = {
            show: true,
            position: app.config.position,
            distance: app.config.distance,
            align: app.config.align,
            verticalAlign: app.config.verticalAlign,
            rotate: app.config.rotate,
            formatter: '{c}  {name|{a}}',
            fontSize: 16,
            rich: {
                name: {
                    textBorderColor: '#fff'
                }
            }
        };

        option = {
            color: ['#003366', '#006699', '#e5323e'],
            tooltip: {
                trigger: 'axis',
                axisPointer: {
                    type: 'shadow'
                }
            },
            legend: {
                data: ['转发数', '评论数', '点赞数']
            },
            toolbox: {
                show: true,
                orient: 'vertical',
                left: 'right',
                top: 'center',
                feature: {
                    mark: {
                        show: true
                    },
                    dataView: {
                        show: true,
                        readOnly: false
                    },
                    magicType: {
                        show: true,
                        type: ['line', 'bar', 'stack', 'tiled']
                    },
                    restore: {
                        show: true
                    },
                    saveAsImage: {
                        show: true
                    }
                }
            },
            xAxis: [{
                type: 'category',
                axisTick: {
                    show: false
                },
                data: x_axis
            }],
            yAxis: [{
                type: 'value'
            }],
            series: [{
                    name: '转发数',
                    type: 'bar',
                    barGap: 0,
                    label: labelOption,
                    data: data1
                },
                {
                    name: '点赞数',
                    type: 'bar',
                    label: labelOption,
                    data: data2
                },
                {
                    name: '评论数',
                    type: 'bar',
                    label: labelOption,
                    data: data3
                }
            ]
        };

        app.setOption(option);
    }


    function draw_word_charts(app, id, data, img) {

        var app = echarts.init(document.getElementById(id));

        // var keywords = {
        //     "visualMap": 22199,
        //     "continuous": 10288,
        //     "contoller": 620,
        //     "series": 274470,
        // };

        // var data = [];
        // for (var name in keywords) {
        //     data.push({
        //         name: name,
        //         value: Math.sqrt(keywords[name])
        //     })
        // }

        var maskImage = new Image();
        maskImage.src = './img/logo.png';

        var option = {
            series: [{
                type: 'wordCloud',
                sizeRange: [10, 100],
                rotationRange: [-90, 90],
                rotationStep: 45,
                gridSize: 2,
                shape: 'pentagon',
                maskImage: maskImage,
                drawOutOfBound: false,
                textStyle: {
                    normal: {
                        color: function () {
                            return 'rgb(' + [
                                Math.round(Math.random() * 160),
                                Math.round(Math.random() * 160),
                                Math.round(Math.random() * 160)
                            ].join(',') + ')';
                        }
                    },
                    emphasis: {
                        color: 'red'
                    }
                },
                data: data.sort(function (a, b) {
                    return b.value - a.value;
                })
            }]
        };

        maskImage.onload = function () {
            option.series[0].maskImage
            app.setOption(option);
        }

    }

    $(function () {
        var app;
        draw_bar_charts(app, "bar_charts_day", ['1', '2', '3'], [100, 100, 100], [200, 240, 500], [300, 300,
            300]);

        var keywords = {
            "visualMap": 22199,
            "continuous": 10288,
            "contoller": 620,
            "series": 274470,
        };

        var data = [];
        for (var name in keywords) {
            data.push({
                name: name,
                value: Math.sqrt(keywords[name])
            })
        }

        var app1;
        draw_word_charts(app1, "word_charts_day", data, "./img/logo.png");

        var app2;
        draw_bar_charts(app2, "bar_charts_yes_day", ['1', '2', '3'], [100, 100, 100], [200, 240, 500], [300, 300,
            300]);

        
        var app3;
        draw_word_charts(app3, "word_charts_yes_day", data, "./img/logo5.png");

    })
</script>