# 08. 采集通道

[TOC]

## 8.1 采集通道启动/停止脚本

1）在/home/atguigu/bin目录下创建脚本cluster.sh
`[atguigu@hadoop102 bin]$ vim cluster.sh`
在脚本中填写如下内容
```bash
#! /bin/bash

case $1 in
"start"){
	echo " -------- 启动 集群 -------"

	echo " -------- 启动 hadoop集群 -------"
	/opt/module/hadoop-2.7.2/sbin/start-dfs.sh 
	ssh hadoop103 "/opt/module/hadoop-2.7.2/sbin/start-yarn.sh"

	#启动 Zookeeper集群
	zk.sh start

sleep 4s;

	#启动 Flume采集集群
	f1.sh start

	#启动 Kafka采集集群
	kf.sh start

sleep 6s;

	#启动 Flume消费集群
	f2.sh start

	#启动 KafkaManager
	km.sh start
};;
"stop"){
    echo " -------- 停止 集群 -------"

	#停止 KafkaManager
	km.sh stop

    #停止 Flume消费集群
	f2.sh stop

	#停止 Kafka采集集群
	kf.sh stop

    sleep 6s;

	#停止 Flume采集集群
	f1.sh stop

	#停止 Zookeeper集群
	zk.sh stop

	echo " -------- 停止 hadoop集群 -------"
	ssh hadoop103 "/opt/module/hadoop-2.7.2/sbin/stop-yarn.sh"
	/opt/module/hadoop-2.7.2/sbin/stop-dfs.sh 
};;
esac
```
2）增加脚本执行权限
`[atguigu@hadoop102 bin]$ chmod 777 cluster.sh`
3）cluster集群启动脚本
`[atguigu@hadoop102 module]$ cluster.sh start`
4）cluster集群停止脚本
`[atguigu@hadoop102 module]$ cluster.sh stop`
